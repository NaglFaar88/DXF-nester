<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DXF Nest Viewer</title>

  <link rel="stylesheet" href="styles.css?v=1" />

  <!-- DXF parser (cdn). Om du redan har detta på annat sätt, behåll din lösning. -->
  <script src="https://cdn.jsdelivr.net/npm/dxf-parser@1.1.2/dist/dxf-parser.min.js"></script>
</head>

<body>
  <div class="app">
    <!-- LEFT: sidebar -->
    <aside class="sidebar">
      <div class="panel">
        <div class="panel-title">Ladda DXF</div>
        <input id="fileInput" type="file" accept=".dxf" multiple />
        <div id="overlay" class="hint">Ladda DXF-filer för att börja</div>
      </div>

      <div class="panel">
        <div class="panel-title">Material</div>

        <select id="materialSelect">
          <option value="1000x1000">1000 × 1000</option>
          <option value="1200x1200">1200 × 1200</option>
          <option value="1500x1500">1500 × 1500</option>
          <option value="1000x2000">1000 × 2000</option>
          <option value="2000x1500">2000 × 1500</option>
          <option value="2000x2000">2000 × 2000</option>
          <option value="custom">Custom size (mm)</option>
        </select>

        <div id="customMaterial" style="display:none; margin-top:10px;">
          <div class="row">
            <label style="flex:1;">
              Bredd (mm)
              <input id="customW" type="number" min="1" value="1000" />
            </label>
            <label style="flex:1;">
              Höjd (mm)
              <input id="customH" type="number" min="1" value="1000" />
            </label>
          </div>
        </div>

        <div id="materialInfo" class="small" style="margin-top:8px;">Material: 1000 × 1000 mm</div>
      </div>

      <div class="panel">
        <div class="panel-title">Mätning</div>

        <div class="row" style="align-items:center;">
          <button id="measureBtn" class="btn">Mät</button>
          <div id="measureStatus" class="badge">Mätläge av</div>
        </div>

        <div id="measureReadout" class="readout"></div>

        <div class="divider"></div>

        <div class="panel-title" style="margin-top:0;">Snäpp (Shift)</div>
        <label class="row" style="align-items:center;">
          <input id="snapEnabled" type="checkbox" checked />
          <span>Aktivera snäpp</span>
        </label>

        <label style="display:block; margin-top:8px;">
          Tolerans (mm)
          <input id="snapTol" type="number" min="0" step="0.1" value="10" />
        </label>

        <div class="small" style="margin-top:8px;">
          Tips: Håll <b>Shift</b> för mjukt snäpp mot materialets kanter/hörn.
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Nestning (M3.1)</div>

        <label style="display:block;">
          Gap (mm)
          <input id="gapMm" type="number" min="0" step="0.1" value="5" />
        </label>

        <label class="row" style="align-items:center; margin-top:8px;">
          <input id="allowRotate" type="checkbox" checked />
          <span>Tillåt rotation (90°)</span>
        </label>

        <button id="nestBtn" class="btn" style="margin-top:10px; width:100%;">Nesta</button>

        <div id="nestNav" style="display:none; margin-top:12px;">
          <div class="row" style="align-items:center;">
            <button id="prevSheetBtn" class="btn btn-secondary">◀</button>
            <div id="sheetInfo" class="badge" style="flex:1; text-align:center;">Ark: 1/1</div>
            <button id="nextSheetBtn" class="btn btn-secondary">▶</button>
          </div>
          <div id="nestStats" class="small" style="margin-top:8px;"></div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Filer</div>
        <div id="fileList" class="file-list"></div>
      </div>
    </aside>

    <!-- RIGHT: canvas -->
    <main class="main">
      <div class="canvas-wrap">
        <canvas id="canvas"></canvas>
      </div>
    </main>
  </div>

  <!-- bumpa ?v=... när du ändrar main.js så cache inte spökar -->
  <script src="main.js?v=1"></script>
</body>
</html>
