<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DXF Nester</title>

  <link rel="stylesheet" href="./styles.css?v=1">

  <!-- UMD build: ger window.DxfParser -->
  <script src="https://cdn.jsdelivr.net/npm/dxf-parser@1.1.7/dist/dxf-parser.min.js"></script>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="panel">
        <h2 class="panel-title">DXF-filer</h2>
        <input id="fileInput" type="file" accept=".dxf" multiple />

        <div class="divider"></div>

        <h3 class="panel-title">Material (mm)</h3>
        <select id="materialSelect">
          <option value="1000x1000">1000 × 1000</option>
          <option value="1200x1200">1200 × 1200</option>
          <option value="1500x1500">1500 × 1500</option>
          <option value="1000x2000">1000 × 2000</option>
          <option value="2000x1500">2000 × 1500</option>
          <option value="2000x2000">2000 × 2000</option>
          <option value="custom">Custom size</option>
        </select>

        <div id="customMaterial" style="display:none; margin-top:10px;">
          <div class="row">
            <div style="flex:1">
              <label>Bredd (mm)</label>
              <input id="customW" type="number" min="1" value="1000" />
            </div>
            <div style="flex:1">
              <label>Höjd (mm)</label>
              <input id="customH" type="number" min="1" value="1000" />
            </div>
          </div>
        </div>

        <div id="materialInfo" class="hint"></div>

        <div class="divider"></div>

        <h3 class="panel-title">Nestning</h3>
        <div class="row">
          <div style="flex:1">
            <label>Gap (mm)</label>
            <input id="gapMm" type="number" min="0" value="5" />
          </div>
          <div style="flex:1; display:flex; align-items:flex-end;">
            <label style="display:flex; align-items:center; gap:8px;">
              <input id="allowRotate" type="checkbox" checked />
              Tillåt rotation
            </label>
          </div>
        </div>

        <div style="margin-top:10px; display:flex; gap:10px;">
          <button id="nestBtn" class="btn">Nesta</button>
        </div>

        <div id="nestNav" style="display:none; margin-top:10px;">
          <div class="row">
            <button id="prevSheetBtn" class="btn btn-secondary" style="width:54px;">◀</button>
            <div id="sheetInfo" class="badge" style="flex:1; text-align:center;">Ark: 1/1</div>
            <button id="nextSheetBtn" class="btn btn-secondary" style="width:54px;">▶</button>
          </div>
          <div id="nestStats" class="hint"></div>
        </div>

        <div class="divider"></div>

        <div id="fileList" class="file-list"></div>
      </div>
    </aside>

    <main class="main">
      <div class="canvas-wrap" style="position:relative;">
        <div id="overlay" class="badge overlay"></div>

        <div class="toolbar">
          <button id="measureBtn" class="btn">Mät</button>
          <div id="measureStatus" class="badge">Mätläge av</div>

          <label class="badge" style="display:flex; align-items:center; gap:8px;">
            <input id="snapEnabled" type="checkbox" checked />
            Snäpp (Shift)
          </label>

          <label class="badge" style="display:flex; align-items:center; gap:8px;">
            ± <input id="snapTol" type="number" min="0" value="5" style="width:70px;">
            mm
          </label>

          <div id="measureReadout" class="badge"></div>
        </div>

        <canvas id="canvas"></canvas>
      </div>
    </main>
  </div>

  <!-- defer så DOM finns när JS kör -->
  <script defer src="./main.js?v=1"></script>
</body>
</html>
